<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Post's</title>
  <meta name="google-site-verification" content="Mc8LxsQoK-5uW934UJLarnvuiH3NMNkiFuhE047OMe4" />

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="shortcut icon" href="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b3/Eo_circle_purple_white_letter-n.svg/2048px-Eo_circle_purple_white_letter-n.svg.png" type="image/x-icon">

  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #1d1e26, #302942);
      color: #ffffff;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      margin-bottom: 140px;

    }

    .photo-post-box {
      width: 100%;
      max-width: 400px;
      background: #27293d;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.4);
      border: 2px solid #5d54a4;
    }

    .photo-post-box .post-image {
      width: 100%;
      height: auto;
      display: block;
      cursor: pointer;
    }

    .photo-post-box .content {
      padding: 0px 20px;
    }

    .photo-post-box .content p {
      font-size: 14px;
      line-height: 1.5;
      color: #b0a8cf;
    }

    .photo-post-box .actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: #1d1e26;
      border-top: 1px solid #5d54a4;
    }

    .photo-post-box .actions button {
      border: none;
      background: none;
      color: #d8b4ff;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: color 0.3s ease;
    }

    .photo-post-box .actions button:hover {
      color: #ff58e7;
    }

    .photo-post-box .actions button i {
      font-size: 18px;
    }

    .photo-post-box .comments {
      padding: 15px 20px;
      background: #1d1e26;
      border-top: 1px solid #5d54a4;
      display: none; /* Initially hidden */
    }

    .photo-post-box .comments .comment {
      font-size: 14px;
      margin-bottom: 8px;
      color: #d8b4ff;
    }

    .photo-post-box .comments input {
      width: 68%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 8px;
      border: 1px solid #5d54a4;
      background: #27293d;
      color: #d8b4ff;
    }

    .photo-post-box .comments button {
      margin-top: 10px;
      padding: 10px;
      border-radius: 8px;
      border: none;
      background: #5d54a4;
      color: #ffffff;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .photo-post-box .comments button:hover {
      background: #ff58e7;
    }

    .profile-pic-placeholder {
      padding: 14px;
      width: 50px;
      height: 50px;
      border-radius: 50px;
    }

    .header {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }
  .bottom-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 80px;
    background: #ffffff;
    border-top: 3px solid #a42eff;
    box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.15);
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 0 15px;
    z-index: 100;
  }

  .icon {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: #6a0dad;
    cursor: pointer;
    transition: all 0.3s ease;
    transition: background 0.3s ease;
  }


  .icon i {
    font-size: 24px;
    color: #6a0dad;
    transition: color 0.3s ease;
  }



  .icon .label {
    margin-top: 5px;
    font-size: 12px;
    color: #6a0dad;
    font-weight: bold;
  }

  /* Notification Badge */
  .notification-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: #a42eff;
    color: #ffffff;
    font-size: 12px;
    width: 20px;
    height: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 50%;
    font-weight: bold;
    box-shadow: 0 0 10px rgba(164, 46, 255, 0.5);
  }

  /* Media Queries for Mobile */
  @media (max-width: 768px) {
    .bottom-bar {
      height: 70px;
      padding: 0 10px;
    }

    .icon {
      width: 40px;
      height: 40px;
    }

    .icon i {
      font-size: 20px;
    }

    .icon .label {
      font-size: 10px;
    }
  }
  .button {
    border: 1px solid #a42eff;
    background-color: #1e1e2f;
    color: white;
    padding: 5px;
    cursor: pointer;
  }
    .main-content {
      flex: 10;
      padding: 15px;
    }

    .main-content h2 {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 20px;
      color: #a42eff;
    }
    video {
        width: 100%;
        max-height: 300px;
        border-radius: 8px;
        margin-top: 10px;
        object-fit: cover;
    }
  </style>
</head>
<body>
  <style>
    .icon-button {
      position: relative;
      width: 50px;
      height: 50px;
      background-color: #a200ff;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      overflow: hidden; /* Ensures images fit within the circle */
    }

    .icon-button .plus {
      color: #fff;
      font-size: 50px;
      font-weight: bold;
    }

    .profile-pic-stories {
      width: 100%; /* Make the image fill the icon */
      height: 100%; /* Keep it proportional */
      object-fit: cover; /* Ensures the image doesn't distort */
      border-radius: 50%; /* Makes the image circular */
    }

    .followers {
      width: 100%;
      background: #302942;
      display: flex;
      flex-wrap: nowrap; /* Keep all items in a single row */
      justify-content: flex-start; /* Align items to the left */
      align-items: center; /* Centers items vertically */
      padding: 10px;
      gap: 10px; /* Space between items */
      overflow-x: auto; /* Add horizontal scroll if needed */
    }

    /* Dynamically adjust icon size when there are many items */
    .followers .icon-button {
      flex: 0 0 calc(100% / 10); /* Adjust based on the number of items */
      max-width: 50px; /* Limit the maximum size */
      max-height: 50px;
    }

    /* Media query to handle smaller screens */
    @media (max-width: 768px) {
      .followers .icon-button {
        flex: 0 0 calc(100% / 5); /* Smaller icons on smaller screens */
        max-width: 40px;
        max-height: 40px;
      }

      .icon-button .plus {
        font-size: 40px; /* Adjust font size for smaller icons */
      }
    }
    /* Container for the button */
    .top-right-button {
      position: fixed; /* Keeps the button fixed at the top-right */
      top: 10px; /* Distance from the top of the page */
      right: 10px; /* Distance from the right of the page */
      z-index: 1000; /* Ensures the button stays on top of other elements */
    }

    /* Button styling */
    .top-right-button button {
      padding: 10px 20px;
      background-color: #a200ff; /* Cyber purple */
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease, background-color 0.3s ease;
    }

    /* Hover effect */
    .top-right-button button:hover {
      background-color: #8a00d4;
      transform: scale(1.1); /* Slightly enlarge the button */
    }
  </style>
<div class="top-right-button">
  {% if user.following.count == 0 %}
  <button onclick="redirectToSite2()">
    Follow to someone
  </button>
    {% else %}
    <button onclick="redirectToSite3()">
      My following
    </button>
    {% endif %}

</div>

<!-- Page content -->

  <div class="followers">
    <!-- Add Follower Button -->
    <div class="icon-button" onclick="redirectToSite()">
      <div class="plus">+</div>
    </div>
    <!-- Follower Icons -->
    {% for follow in profile.following.all %}
    <a href="{% url 'user_profile' follow.follower.username %}">
      <div class="icon-button">
        {% if follow.following.profile_pic %}
        <img src="{{ follow.following.profile_pic.url }}" alt="Profile Picture" class="profile-pic-stories">
        {% else %}
        {% if user.gender == "M" %}
        <img src="https://gifdb.com/images/thumbnail/profile-pic-storm-troopers-star-wars-u776e7rxopb05g64.gif" alt="Male Placeholder" class="profile-pic-stories">
        {% else %}
        <img src="https://cdn.pfps.gg/pfps/1682-purple-warm-cool-wow.gif" alt="Female Placeholder" class="profile-pic-stories">
        {% endif %}
        {% endif %}
      </div>
    </a>
    {% empty %}
    {% endfor %}
  </div>
</body>

<script>
function redirectToSite() {
    window.location.href = "{% url 'create_stories' %}"; // Replace with your desired URL
}
function redirectToSite2(){
  window.location.href = "{%  url 'users_list' %}";

}
function redirectToSite3() {
  window.location.href = "{%  url 'profile' %}"

}
</script>

<div class="bottom-bar">
  <a href="{% url 'recomand' %}" class="icon">
    <i class="fas fa-home"></i>
    <div class="label">Home</div>
  </a>
  <a href="{% url 'users_list' %}" class="icon">
      <i class="fas fa-users"></i>
      <div class="label">Search</div>
    </a>

  <!-- Search Icon -->


  

  <!-- Photos Icon (Updated to Camera Icon) -->
  <a href="{% url 'search_page' %}" class="icon">
    <i class="fas fa-search"></i>
    <div class="label">Network</div>
  </a>

  <!-- Inbox Icon (Updated to Message Icon) -->
   {% if friend_requests_count != 0 %}
  <a href="{% url 'inbox' %}" class="icon">
    <i class="fas fa-envelope"></i>
    
    <div class="notification-badge" id="notificationCount">{{ friend_requests_count }}</div>
    <div class="label">Inbox</div>
  </a>
  {% endif %}
  
  <!-- Friends Icon 
  <a href="#" class="icon">
    <i class="fas fa-users"></i>
    <div class="label">Friends</div>
  </a>
-->
  <!-- Shorts Icon (Updated to Video Icon) -->

  <!-- Profile Icon -->
  <style>
    .bottom-bar img {
  top: 0px;
    width: 25px;
    height: 25px;
    border-radius: 1000px;
    object-fit: cover;

}
 </style>
<a href="{% url 'profile' %}" class="icon">
    {% if request.user.profile_pic %}
    <img src="{{ request.user.profile_pic.url }}" alt="Profile Picture" >
{% else %}
    {% if user.gender == "M" %}
    <img src="https://t3.ftcdn.net/jpg/04/43/94/64/360_F_443946404_7GUoIGZeyx7R7ymCicI3k0xPnrMoKDek.webp" alt="Male Placeholder" class="profile-image">
    {% else %}
        <img src="https://media.istockphoto.com/id/1327592664/ru/%D0%B2%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%BD%D0%B0%D1%8F/%D0%B7%D0%BD%D0%B0%D1%87%D0%BE%D0%BA-%D0%B7%D0%B0%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D1%8F-%D1%84%D0%BE%D1%82%D0%BE-%D0%B0%D0%B2%D0%B0%D1%82%D0%B0%D1%80%D0%B0-%D0%BF%D0%BE-%D1%83%D0%BC%D0%BE%D0%BB%D1%87%D0%B0%D0%BD%D0%B8%D1%8E-%D1%81%D0%B5%D1%80%D0%BE%D0%B5-%D0%B8%D0%B7%D0%BE%D0%B1%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D1%84%D0%B8%D0%BB%D1%8F-%D0%B4%D0%B5%D0%BB%D0%BE%D0%B2%D0%B0%D1%8F-%D0%B6%D0%B5%D0%BD%D1%89%D0%B8%D0%BD%D0%B0.jpg?s=170667a&w=0&k=20&c=zSkOCGQKzshhVaqfS6hHsmUYbOQopoz0Z3dcPllf8uE=" alt="Female Placeholder" class="profile-image">
    {% endif %}
{% endif %}
    <div class="label">Profile</div>
  </a>



</div>
  <!-- Post -->
  {% for post in posts %}
  <div class="photo-post-box">
    <div class="header">
      {% if post.user.profile_pic %}
        <img src="{{ post.user.profile_pic.url }}" alt="Profile Picture" class="profile-pic-placeholder">
      {% else %}
      {% if user.gender == "M" %}
      <img src="https://gifdb.com/images/thumbnail/profile-pic-storm-troopers-star-wars-u776e7rxopb05g64.gif" alt="Male Placeholder" class="profile-pic-placeholder">
  {% else %}
      <img src="https://cdn.pfps.gg/pfps/1682-purple-warm-cool-wow.gif" alt="Female Placeholder" class="profile-pic-placeholder">
  {% endif %}
      {% endif %}
      <h5>{{ post.user.username }}</h5>
    </div>
    
{% if post.video %}
<video controls>
    <source src="{{ post.video.url }}" type="video/mp4">
</video>
{% endif %}
    <div class="content">
      <p>{{ post.caption }}</p>
    </div>
    <div class="actions">
      <button class="like-btn" data-post-id="{{ post.id }}">
        {% if post.has_liked %}
        <i class="fas fa-thumbs-down"></i>
        {% else %}
        <i class="fas fa-thumbs-up"></i>
        {% endif %}
        <span class="like-count">{{ post.likes_stories.count }}</span>
      </button>
      <button class="toggle-comments" onclick="toggleComments('{{ post.id }}')">
        <i class="fas fa-comments"></i> Comments <span>{{ post.comments.count }}</span>
      </button>
    </div>
    <div class="comments" id="comments-{{ post.id }}">
        {% for comment in post.comments_list %}
          <div class="header">
            {% if comment.user.profile_pic %}
              <img src="{{ comment.user.profile_pic.url }}" alt="" class="profile-pic-placeholder">
            {% else %}
            {% if user.gender == "M" %}
            <img src="https://gifdb.com/images/thumbnail/profile-pic-storm-troopers-star-wars-u776e7rxopb05g64.gif" alt="Male Placeholder" class="profile-pic-placeholder">
        {% else %}
            <img src="https://cdn.pfps.gg/pfps/1682-purple-warm-cool-wow.gif" alt="Female Placeholder" class="profile-pic-placeholder">
        {% endif %}
            {% endif %}
            <strong>{{ comment.user.username }}</strong>: {{ comment.content }}
          </div>
        {% endfor %}
        <form method="POST">
          {% csrf_token %}
          <input name="content" placeholder="Add a comment">
          <input type="hidden" name="post_id" value="{{ post.id }}">
          <button type="submit">Share</button>
        </form>
      </div>
    </div>
    {% empty %}
    <p>No stories post</p>
    {% endfor %}
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      // Like post functionality
      $(document).ready(function() {
      $(".like-btn").click(function() {
        var postId = $(this).data("post-id");
        var button = $(this);
        $.ajax({
          url: "{% url 'like_stories' %}",
          type: "POST",
          data: {
            'post_id': postId,
            'csrfmiddlewaretoken': '{{ csrf_token }}'
          },
          success: function(response) {
                    if (response.success) {
                        var icon = button.find("i");
                        if (icon.hasClass('fa-thumbs-down')) {
                            icon.removeClass('fa-thumbs-down').addClass('fa-thumbs-up');
                        } else {
                            icon.removeClass('fa-thumbs-up').addClass('fa-thumbs-down');
                        }
                        button.find(".like-count").text(response.like_count);
                    }
                }
        });
      });
    });
  
      // Toggle comments visibility
      function toggleComments(postId) {
        const commentsDiv = document.getElementById(`comments-${postId}`);
        commentsDiv.style.display = commentsDiv.style.display === "none" ? "block" : "none";
      }
    </script>
  </body>
  </html>
  